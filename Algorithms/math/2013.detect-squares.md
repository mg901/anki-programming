## [2013 Detect Squares](https://leetcode.com/problems/detect-squares/description/)

```js
class DetectSquares {
  constructor() {
    this.points = new Map(); // key: x, value: Map of y -> count
  }

  add([x, y]) {
    if (!this.points.has(x)) {
      this.points.set(x, new Map());
    }

    const yFreqMap = this.points.get(x);
    yFreqMap.set(y, (yFreqMap.get(y) ?? 0) + 1);
  }

  count([x, y]) {
    let count = 0;
    if (!this.points.has(x)) return 0;

    const yFreqMap = this.points.get(x);

    for (const [x2, yFreqMap2] of this.points.entries()) {
      if (x2 === x) continue;

      const diff = x2 - x;

      for (const deltaY of [diff, -diff]) {
        const y1 = y + deltaY;

        const c1 = yFreqMap2.get(y) ?? 0;
        const c2 = yFreqMap2.get(y1) ?? 0;
        const c3 = yFreqMap.get(y1) ?? 0;

        count += c1 * c2 * c3;
      }
    }

    return count;
  }
}
```
