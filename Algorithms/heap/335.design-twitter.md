## [355 Design Twitter](https://leetcode.com/problems/design-twitter/description/)

<!-- notecardId: 1767900749788 -->

```js
// Explanation:
// - Neetcode: https://youtu.be/pNichitDD2E

class Twitter {
  #idToFollowees = new Map();

  #idToTweets = new Map();

  #timestamp = 0;

  #limit = 10;

  // - Time: O(1)
  postTweet(userId, tweetId) {
    let tweets = this.#idToTweets.get(userId);

    if (!tweets) {
      tweets = [];
      this.#idToTweets.set(userId, tweets);
    }

    tweets.push({
      timestamp: (this.#timestamp += 1),
      tweetId,
    });
  }

  // - Time: O(f + k log(f))
  //    where:
  //      f = followees.length + 1 (self)
  //      k = limit
  //
  // - Space: O(f)
  getNewsFeed(userId) {
    const followees = this.#idToFollowees.get(userId);
    const users = new Set(followees);
    users.add(userId);

    const maxHeap = new MaxHeap((node) => node.tweet.timestamp);

    for (const id of users) {
      const tweets = this.#idToTweets.get(id);
      if (!tweets || tweets.length === 0) continue;

      const lastIdx = tweets.length - 1;

      maxHeap.push({
        tweets,
        tweet: tweets[lastIdx],
        index: lastIdx - 1,
      });
    }

    const newsFeed = [];

    while (!maxHeap.isEmpty() && newsFeed.length < this.#limit) {
      const { index, tweet, tweets } = maxHeap.pop();
      newsFeed.push(tweet.tweetId);

      if (index >= 0) {
        maxHeap.push({
          tweets,
          tweet: tweets[index],
          index: index - 1,
        });
      }
    }

    return newsFeed;
  }

  // - Time: O(1)
  follow(followerId, followeeId) {
    let followees = this.#idToFollowees.get(followerId);

    if (!followees) {
      followees = new Set();
      this.#idToFollowees.set(followerId, followees);
    }

    followees.add(followeeId);
  }

  // - Time: O(1)
  unfollow(followerId, followeeId) {
    this.#idToFollowees.get(followerId)?.delete(followeeId);
  }
}
```
