## [309 Best Time to Buy and Sell Stock with Cooldown](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/description/)

<!-- notecardId: 1753904250541 -->

```js
// Bottom-up
// - Time: O(n)
// - Space: O(n)
function maxProfit(prices) {
  const n = prices.length;
  if (n === 0) return 0;

  // 0: sold, 1: held, 2: rest
  const dp = Array.from({ length: 3 }, () => new Array(n).fill(0));

  dp[0][0] = 0; // sold
  dp[1][0] = -prices[0]; // held

  for (let i = 1; i < n; i += 1) {
    dp[0][i] = dp[1][i - 1] + prices[i]; // sold
    dp[1][i] = Math.max(dp[1][i - 1], dp[2][i - 1] - prices[i]); // held
    dp[2][i] = Math.max(dp[0][i - 1], dp[2][i - 1]); // rest
  }

  return Math.max(dp[0][n - 1], dp[2][n - 1]);
}

// Space Optimized
// - Time: O(n)
// - Space: O(1)
function maxProfit(prices) {
  const n = prices.length;
  if (n === 0) return 0;

  let sold = 0;
  let held = -prices[0];
  let rest = 0;

  for (let i = 1; i < n; i += 1) {
    const prevHold = held;
    const prevSold = sold;
    const prevRest = rest;

    sold = prevHold + prices[i];
    held = Math.max(prevHold, prevRest - prices[i]);
    rest = Math.max(prevRest, prevSold);
  }

  return Math.max(sold, rest);
}
```
