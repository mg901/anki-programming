## [324 Wiggle Sort II 'Brute force'](https://leetcode.com/problems/wiggle-sort-ii/description/)

<!-- notecardId: 1769203543033 -->

```js
// - Time: O(n)
// - Space: O(n)
function wiggleSort(nums) {
  const n = nums.length;
  const sorted = nums.toSorted((a, b) => a - b);

  let mid = Math.floor((n - 1) / 2);
  let right = n - 1;

  for (let i = 0; i < n; i += 1) {
    if (i % 2 === 0) {
      nums[i] = sorted[mid];
      mid -= 1;
    }

    if (i % 2 === 1) {
      nums[i] = sorted[right];
      right -= 1;
    }
  }
}
```

## [324 Wiggle Sort II](https://leetcode.com/problems/wiggle-sort-ii/description/)

<!-- notecardId: 1769251762099 -->

```js
// Algorithms:
// - Quick Select
// - 3-way partition

// Approach: Virtual indexing

// - Time: O(n)
// - Space: O(1)
function wiggleSort(nums) {
  const n = nums.length;
  if (n < 2) return;

  const mid = (n - 1) >> 1;
  const median = quickSelect(nums, mid);

  const virtualIdx = (i) => ((i << 1) + 1) % (n | 1);

  let larger = 0;
  let current = 0;
  let smaller = n - 1;

  while (current <= smaller) {
    const vCurrent = virtualIdx(current);

    if (nums[vCurrent] > median) {
      swap(nums, virtualIdx(larger), vCurrent);
      larger += 1;
      current += 1;
    } else if (nums[vCurrent] === median) {
      current += 1;
    } else {
      swap(nums, vCurrent, virtualIdx(smaller));
      smaller -= 1;
    }
  }
}

function quickSelect(nums, kIndex, left = 0, right = nums.length - 1) {
  while (true) {
    if (right === left) {
      return nums[left];
    }

    const boundary = hoarePartition(nums, left, right);

    if (kIndex <= boundary) {
      right = boundary;
    } else {
      left = boundary + 1;
    }
  }
}

function hoarePartition(nums, left, right) {
  const randomIdx = randomInt(left, right);
  const pivot = nums[randomIdx];

  let i = left - 1;
  let j = right + 1;

  while (true) {
    do i += 1;
    while (nums[i] < pivot);

    do j -= 1;
    while (nums[j] > pivot);

    if (i >= j) return j;

    swap(nums, i, j);
  }
}

function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function swap(nums, i, j) {
  if (i === j) return;

  const temp = nums[j];
  nums[j] = nums[i];
  nums[i] = temp;
}
```
